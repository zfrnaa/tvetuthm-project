import { Routes, Route, useLocation } from "react-router-dom";
import Dashboard from "./pages/dashboard.tsx";
import Login from "./auth/login.tsx";
import Laporan from "./pages/laporan";
import Maklumat from "./pages/maklumat";
import MengenaiSistem from "./pages/mengenai-sistem";
import Header from "./components/ui/Header";
import { useTheme } from "./lib/contexts/ThemeContext.tsx";
import FooterWithSocialLinks from "./components/ui/footer.tsx";

export default function Layout() {
  const { gradientColors } = useTheme();

  const location = useLocation(); // ✅ Get the current route

  // ✅ Hide header on login page
  const hideHeader = location.pathname === "/auth/login";

  return (
    <div className="relative h-screen w-screen">
      {/* ✅ Full-screen Background Gradient (Always Covers Entire Page) */}
      {!hideHeader && (
        <div
          className="fixed top-0 left-0 w-full h-full"
          style={{
            background: `linear-gradient(${gradientColors?.[0] || "#f3f3f3"}, ${gradientColors?.[1] || "#a3bffa"})`, // ✅ Ensures it stays in the background
          }}
        />
      )}

      {/* ✅ Header (Only if NOT login page) */}
      {!hideHeader && <Header />}
      {/* <div className="flex flex-1 flex-col min-h-screen"> */}

      {/* ✅ Main Content */}
      <main className="relative z-10 flex-grow">

        {/* <div className="flex flex-col flex-1"> */}
        <Routes>
          <Route path="/dashboard" element={<Dashboard />} />
          <Route path="/auth/login" element={<Login />} />
          <Route path="/laporan" element={<Laporan />} />
          <Route path="/maklumat" element={<Maklumat />} />
          <Route path="/mengenai-sistem" element={<MengenaiSistem />} />
        </Routes>
      </main>
      {!hideHeader && <FooterWithSocialLinks />}
    </div>
  )
}

// <UserProvider>
//   <WindowDimensionsProvider>
//     <ThemeProvider>
//       <I18nextProvider i18n={i18n}>
//         {/* ✅ Gradient Background (Hidden on Login Page) */}
//         {!hideHeader && (
//           <div
//             className="absolute inset-0 -z-10"
//             style={{ background: `linear-gradient(${gradientColors[0]}, ${gradientColors[1]})` }}
//           />
//         )}

//         {/* ✅ Conditionally render Header (Hidden on Login Page) */}
//         {!hideHeader && <Header />}

//         <Routes>
//           <Route path="/dashboard" element={<Dashboard />} />
//           <Route path="/auth/login" element={<Login />} />
//           <Route path="/laporan" element={<Laporan />} />
//           <Route path="/maklumat" element={<Maklumat />} />
//           <Route path="/mengenai-sistem" element={<MengenaiSistem />} />
//         </Routes>
//       </I18nextProvider>
//     </ThemeProvider>
//   </WindowDimensionsProvider>
// </UserProvider>